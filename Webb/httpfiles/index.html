<!DOCTYPE>
<html>
<head>
    <link rel="stylesheet" href="/httpfiles/style.css">
    <script src="/httpfiles/linq.js"></script>
    <script src="/httpfiles/Accessor.js"></script>
    <script src="/httpfiles/EventManager.js"></script>
    <script src="/httpfiles/Formatter.js"></script>
    <script src="/httpfiles/Graph.js"></script>
</head>
<body id="body">
    <div class="top"><img src="httpfiles/logo.png"><div id="time" class="time"></div></div>
    <div id="menu" class="menu">
    </div>

    <div class="content" id="content">
        <canvas id="posgraph" width="600" height="300"></canvas>
    </div>

    <script>

        var eventManager = new EventManager("%eventDirectory%");
        var formatter = new Formatter(eventManager, document, window, history, "content");

        let menuItems = formatter.GetOptions();

        const menuElement = document.getElementById("menu");

        menuElement.innerHTML = "";

        let url = new URL(this.window.location.href.replace("#", ""));

        let shown = false;

        for (const item of menuItems)
        {
            const div = document.createElement("div");
            div.className = "menu-item";
            menuElement.appendChild(div);

            const link = document.createElement("a");
            link.setAttribute('href', "#");
            link.onclick = function () { formatter.Show(item); };
            link.innerText = item;
            div.appendChild(link);

            if (url.pathname == "/" + item)
            {
                formatter.Show(item);
                shown = true;
            }
        }

        if (!shown)
        {
            formatter.ShowEventStatus();
        }
        

    </script>
</body>
</html>